<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cl.rticket.mappers.ItemMapper">

<select id="obtenerPartidos" resultType="Partido" parameterType="int">
   select equ_id idEquipo,
          par_id idPartido,
          CONCAT (par_desc, ' ',DATE_FORMAT(par_fecha , '%d/%m/%Y')) descripcion         
    from partido where equ_id=#{idEquipo}
</select>

<select id="obtenerSectores" resultType="Sector" parameterType="int">
   select equ_id idEquipo,
          sec_id idSector,
          sec_desc descripcion
    from sector where equ_id=#{idEquipo}
</select>


<select id="obtenerEntradas" resultType="Entrada" parameterType="map">
   select  a.ent_id idEntrada, a.par_id idPartido , a.ent_precio precio ,
           p.par_desc descPartido, CONCAT(s.sec_desc,' - $',a.ent_precio) descSector
          
   from entrada a, partido p, sector s
   where
	   a.par_id = #{idPartido} and 
	   a.equ_id = #{idEquipo} and
	   a.sec_id = s.sec_id and
	   a.par_id = p.par_id
</select>



<insert id="insertarEntrada" parameterType="Entrada">
   insert into entrada (equ_id,ent_id, sec_id, par_id, ent_precio, ent_fecha_creacion)
   values 
       (#{idEquipo},NULL, #{idSector}, #{idPartido}, #{precio},NOW())
</insert>

<delete id="eliminarEntrada" parameterType="map">
  delete from entrada where equ_id=#{idEquipo}  and ent_id = #{idEntrada}
</delete>
</mapper>